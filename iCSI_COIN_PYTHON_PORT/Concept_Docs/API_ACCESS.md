# iCSI Coin API Access Guide üîê

To enhance security, the iCSI Coin node requires strict authentication for **ALL** API interactions.
**Base URL:** `http://localhost:8080` (or your configured port)

## Authentication Method

You must include your `username` and `password` in the JSON body of every request.
This applies even to endpoints that retrieve data (like `/api/peers` or `/api/wallet/list`).

**Format:**
```json
{
    "username": "your_username",
    "password": "your_password",
    ...other_parameters
}
```

---

## Endpoints

### 1. Network & Status

#### Get Network Stats
Retrieves current block height, difficulty, and mining info.

- **URL:** `/api/stats`
- **Method:** `POST`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/stats \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

#### List Peers
Lists all connected and known peers.

- **URL:** `/api/peers`
- **Method:** `POST`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/peers \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

---

### 2. Wallet Management

#### List Wallets
Returns all addresses generated by this node and their balances.

- **URL:** `/api/wallet/list`
- **Method:** `POST`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/wallet/list \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

#### Create Wallet
Generates a new address.

- **URL:** `/api/wallet/create`
- **Method:** `POST`
- **Parameters:** `name` (optional label)
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/wallet/create \
       -H "Content-Type: application/json" \
       -d '{
             "username": "admin", 
             "password": "securepassword",
             "name": "Savings"
           }'
  ```

#### Send Coins
Transfers coins to another address.

- **URL:** `/api/wallet/send`
- **Method:** `POST`
- **Parameters:** `to` (address), `amount`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/wallet/send \
       -H "Content-Type: application/json" \
       -d '{
             "username": "admin", 
             "password": "securepassword",
             "to": "1DestAddress...",
             "amount": 50
           }'
  ```

#### Import Keys
Import private keys (dictionaries).

- **URL:** `/api/wallet/import`
- **Method:** `POST`
- **Body:** List of key objects
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/wallet/import \
       -H "Content-Type: application/json" \
       -d '[
             {"username": "admin", "password": "securepassword"},
             {"priv": "...", "pub": "...", "addr": "..."}
           ]' 
  # Note: The username/password must be merged into the request or handled via session cookie if list structure prevents it.
  # Recommendation: Use Session Cookie for this specific complex endpoint:
  curl -c cookie.jar -X POST http://localhost:8080/api/auth/login -d '...'
  curl -b cookie.jar -X POST http://localhost:8080/api/wallet/import -d '[...]'
  ```

---

### 3. Mining

#### Start Miner
Starts the background mining process.

- **URL:** `/api/miner/start`
- **Method:** `POST`
- **Parameters:** `target_address` (optional)
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/miner/start \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

#### Stop Miner
Stops the miner.

- **URL:** `/api/miner/stop`
- **Method:** `POST`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/miner/stop \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

---

### 4. Explorer Data

#### Get Blocks (Paginated)
- **URL:** `/api/explorer/blocks?page=1`
- **Method:** `POST` (Auth in body, params in URL)
- **Example:**
  ```bash
  curl -X POST "http://localhost:8080/api/explorer/blocks?page=1" \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

#### Get Block Detail
- **URL:** `/api/explorer/block/<hash>`
- **Method:** `POST`
- **Example:**
  ```bash
  curl -X POST http://localhost:8080/api/explorer/block/00000abc... \
       -H "Content-Type: application/json" \
       -d '{"username": "admin", "password": "securepassword"}'
  ```

---

### NOTE: Session Cookies
You can still use session cookies (via `/api/auth/login`) if you prefer not to send credentials with every request, especially for browser-based interaction.
